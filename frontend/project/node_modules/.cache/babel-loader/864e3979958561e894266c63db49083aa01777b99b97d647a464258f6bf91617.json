{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.some.js\";\n/*\r\n\r\nimport axios from 'axios'\r\n\r\nconst apiClient = axios.create({\r\n  baseURL: 'http://ajax-api.itheima.net',\r\n  withCredentials: false,\r\n  headers: {\r\n    Accept: 'application/json',\r\n    'Content-Type': 'application/json'\r\n  }\r\n})\r\n*/\n\nexport default {\n  login(user) {\n    const roles = ['business', 'buyer', 'admin'];\n    for (const role of roles) {\n      const key = `${role}Users`;\n      const users = JSON.parse(localStorage.getItem(key) || '[]');\n\n      // 正确比较用户输入的密码和存储的密码\n      const foundUser = users.find(u => u.userId === user.userId && u.password === user.password);\n      if (foundUser) {\n        return Promise.resolve({\n          data: {\n            token: 'simulated-token',\n            userId: foundUser.userId,\n            userName: foundUser.userName,\n            role: foundUser.role\n          }\n        });\n      }\n    }\n    return Promise.reject(new Error('用户ID或密码错误'));\n  },\n  register(user) {\n    return new Promise((resolve, reject) => {\n      // 确保键名格式正确：role + \"Users\"\n      const key = `${user.role}Users`;\n      const users = JSON.parse(localStorage.getItem(key) || '[]');\n\n      // 用户ID查重\n      if (users.some(u => u.userId === user.userId)) {\n        reject(new Error('用户ID已存在'));\n        return;\n      }\n\n      // 创建新用户对象\n      const newUser = {\n        userId: user.userId,\n        userName: user.userName,\n        password: user.password,\n        role: user.role\n      };\n\n      // 更新存储\n      users.push(newUser);\n      localStorage.setItem(key, JSON.stringify(users));\n\n      // 调试信息：打印存储的用户数据\n      console.log(`注册成功！存储到键: ${key}`);\n      console.log('存储的用户数据:', newUser);\n      console.log('当前所有用户:', users);\n      resolve({\n        data: {\n          message: '注册成功',\n          user: newUser\n        }\n      });\n    });\n  }\n};","map":{"version":3,"names":["login","user","roles","role","key","users","JSON","parse","localStorage","getItem","foundUser","find","u","userId","password","Promise","resolve","data","token","userName","reject","Error","register","some","newUser","push","setItem","stringify","console","log","message"],"sources":["E:/实验例子/project/src/services/auth.js"],"sourcesContent":["/*\r\n\r\nimport axios from 'axios'\r\n\r\nconst apiClient = axios.create({\r\n  baseURL: 'http://ajax-api.itheima.net',\r\n  withCredentials: false,\r\n  headers: {\r\n    Accept: 'application/json',\r\n    'Content-Type': 'application/json'\r\n  }\r\n})\r\n*/\r\n\r\nexport default {\r\n  login(user) {\r\n    const roles = ['business', 'buyer', 'admin'];\r\n    for (const role of roles) {\r\n      const key = `${role}Users`;\r\n      const users = JSON.parse(localStorage.getItem(key) || '[]');\r\n      \r\n      // 正确比较用户输入的密码和存储的密码\r\n      const foundUser = users.find(u => \r\n        u.userId === user.userId && u.password === user.password\r\n      );\r\n      \r\n      if (foundUser) {\r\n        return Promise.resolve({\r\n          data: {\r\n            token: 'simulated-token',\r\n            userId: foundUser.userId,\r\n            userName: foundUser.userName,\r\n            role: foundUser.role\r\n          }\r\n        });\r\n      }\r\n    }\r\n    return Promise.reject(new Error('用户ID或密码错误'));\r\n  },\r\n\r\n  register(user) {\r\n    return new Promise((resolve, reject) => {\r\n      // 确保键名格式正确：role + \"Users\"\r\n      const key = `${user.role}Users`;\r\n      const users = JSON.parse(localStorage.getItem(key) || '[]');\r\n\r\n      // 用户ID查重\r\n      if (users.some(u => u.userId === user.userId)) {\r\n        reject(new Error('用户ID已存在'));\r\n        return;\r\n      }\r\n\r\n      // 创建新用户对象\r\n      const newUser = {\r\n        userId: user.userId,\r\n        userName: user.userName,\r\n        password: user.password,\r\n        role: user.role\r\n      };\r\n\r\n      // 更新存储\r\n      users.push(newUser);\r\n      localStorage.setItem(key, JSON.stringify(users));\r\n      \r\n      // 调试信息：打印存储的用户数据\r\n      console.log(`注册成功！存储到键: ${key}`);\r\n      console.log('存储的用户数据:', newUser);\r\n      console.log('当前所有用户:', users);\r\n      \r\n      resolve({ \r\n        data: {\r\n          message: '注册成功',\r\n          user: newUser\r\n        }\r\n      });\r\n    });\r\n  }\r\n}"],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe;EACbA,KAAKA,CAACC,IAAI,EAAE;IACV,MAAMC,KAAK,GAAG,CAAC,UAAU,EAAE,OAAO,EAAE,OAAO,CAAC;IAC5C,KAAK,MAAMC,IAAI,IAAID,KAAK,EAAE;MACxB,MAAME,GAAG,GAAG,GAAGD,IAAI,OAAO;MAC1B,MAAME,KAAK,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAACL,GAAG,CAAC,IAAI,IAAI,CAAC;;MAE3D;MACA,MAAMM,SAAS,GAAGL,KAAK,CAACM,IAAI,CAACC,CAAC,IAC5BA,CAAC,CAACC,MAAM,KAAKZ,IAAI,CAACY,MAAM,IAAID,CAAC,CAACE,QAAQ,KAAKb,IAAI,CAACa,QAClD,CAAC;MAED,IAAIJ,SAAS,EAAE;QACb,OAAOK,OAAO,CAACC,OAAO,CAAC;UACrBC,IAAI,EAAE;YACJC,KAAK,EAAE,iBAAiB;YACxBL,MAAM,EAAEH,SAAS,CAACG,MAAM;YACxBM,QAAQ,EAAET,SAAS,CAACS,QAAQ;YAC5BhB,IAAI,EAAEO,SAAS,CAACP;UAClB;QACF,CAAC,CAAC;MACJ;IACF;IACA,OAAOY,OAAO,CAACK,MAAM,CAAC,IAAIC,KAAK,CAAC,WAAW,CAAC,CAAC;EAC/C,CAAC;EAEDC,QAAQA,CAACrB,IAAI,EAAE;IACb,OAAO,IAAIc,OAAO,CAAC,CAACC,OAAO,EAAEI,MAAM,KAAK;MACtC;MACA,MAAMhB,GAAG,GAAG,GAAGH,IAAI,CAACE,IAAI,OAAO;MAC/B,MAAME,KAAK,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAACL,GAAG,CAAC,IAAI,IAAI,CAAC;;MAE3D;MACA,IAAIC,KAAK,CAACkB,IAAI,CAACX,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAKZ,IAAI,CAACY,MAAM,CAAC,EAAE;QAC7CO,MAAM,CAAC,IAAIC,KAAK,CAAC,SAAS,CAAC,CAAC;QAC5B;MACF;;MAEA;MACA,MAAMG,OAAO,GAAG;QACdX,MAAM,EAAEZ,IAAI,CAACY,MAAM;QACnBM,QAAQ,EAAElB,IAAI,CAACkB,QAAQ;QACvBL,QAAQ,EAAEb,IAAI,CAACa,QAAQ;QACvBX,IAAI,EAAEF,IAAI,CAACE;MACb,CAAC;;MAED;MACAE,KAAK,CAACoB,IAAI,CAACD,OAAO,CAAC;MACnBhB,YAAY,CAACkB,OAAO,CAACtB,GAAG,EAAEE,IAAI,CAACqB,SAAS,CAACtB,KAAK,CAAC,CAAC;;MAEhD;MACAuB,OAAO,CAACC,GAAG,CAAC,cAAczB,GAAG,EAAE,CAAC;MAChCwB,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEL,OAAO,CAAC;MAChCI,OAAO,CAACC,GAAG,CAAC,SAAS,EAAExB,KAAK,CAAC;MAE7BW,OAAO,CAAC;QACNC,IAAI,EAAE;UACJa,OAAO,EAAE,MAAM;UACf7B,IAAI,EAAEuB;QACR;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}