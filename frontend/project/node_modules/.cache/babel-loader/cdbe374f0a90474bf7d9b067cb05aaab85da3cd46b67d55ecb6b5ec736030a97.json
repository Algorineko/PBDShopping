{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"user-reviews\"\n};\nconst _hoisted_2 = {\n  class: \"product-info\"\n};\nconst _hoisted_3 = {\n  class: \"product-details\"\n};\nconst _hoisted_4 = {\n  class: \"product-name\"\n};\nconst _hoisted_5 = {\n  class: \"product-price\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_image = _resolveComponent(\"el-image\");\n  const _component_el_rate = _resolveComponent(\"el-rate\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  const _component_el_empty = _resolveComponent(\"el-empty\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[8] || (_cache[8] = _createElementVNode(\"h2\", null, \"评价管理\", -1 /* HOISTED */)), _createVNode(_component_el_table, {\n    data: $setup.reviews,\n    border: \"\",\n    style: {\n      \"width\": \"100%\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_table_column, {\n      prop: \"orderId\",\n      label: \"订单ID\",\n      width: \"120\"\n    }), _createVNode(_component_el_table_column, {\n      label: \"商品信息\",\n      width: \"300\"\n    }, {\n      default: _withCtx(({\n        row\n      }) => [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_image, {\n        src: row.productImage || '/placeholder-product.jpg',\n        style: {\n          \"width\": \"60px\",\n          \"height\": \"60px\"\n        },\n        fit: \"cover\"\n      }, null, 8 /* PROPS */, [\"src\"]), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, _toDisplayString(row.productName || '商品信息缺失'), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_5, \"¥\" + _toDisplayString((row.productPrice || 0).toFixed(2)) + \" × \" + _toDisplayString(row.quantity || 1), 1 /* TEXT */)])])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_table_column, {\n      label: \"评分\",\n      width: \"120\"\n    }, {\n      default: _withCtx(scope => [_createVNode(_component_el_rate, {\n        modelValue: scope.row.rating,\n        \"onUpdate:modelValue\": $event => scope.row.rating = $event,\n        disabled: \"\",\n        \"show-score\": \"\",\n        \"text-color\": \"#ff9900\"\n      }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_table_column, {\n      prop: \"content\",\n      label: \"评价内容\"\n    }), _createVNode(_component_el_table_column, {\n      prop: \"date\",\n      label: \"评价时间\",\n      width: \"180\"\n    }), _createVNode(_component_el_table_column, {\n      label: \"操作\",\n      width: \"150\"\n    }, {\n      default: _withCtx(({\n        row\n      }) => [_createVNode(_component_el_button, {\n        size: \"small\",\n        onClick: $event => $setup.editReview(row)\n      }, {\n        default: _withCtx(() => _cache[4] || (_cache[4] = [_createTextVNode(\"编辑\")])),\n        _: 2 /* DYNAMIC */,\n        __: [4]\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_el_button, {\n        type: \"danger\",\n        size: \"small\",\n        onClick: $event => $setup.deleteReview(row)\n      }, {\n        default: _withCtx(() => _cache[5] || (_cache[5] = [_createTextVNode(\"删除\")])),\n        _: 2 /* DYNAMIC */,\n        __: [5]\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"data\"]), $setup.reviews.length === 0 ? (_openBlock(), _createBlock(_component_el_empty, {\n    key: 0,\n    description: \"暂无评价记录\",\n    class: \"empty-tip\"\n  })) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 编辑对话框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $setup.editDialogVisible,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.editDialogVisible = $event),\n    title: \"编辑评价\"\n  }, {\n    footer: _withCtx(() => [_createVNode(_component_el_button, {\n      onClick: _cache[2] || (_cache[2] = $event => $setup.editDialogVisible = false)\n    }, {\n      default: _withCtx(() => _cache[6] || (_cache[6] = [_createTextVNode(\"取消\")])),\n      _: 1 /* STABLE */,\n      __: [6]\n    }), _createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $setup.saveEdit\n    }, {\n      default: _withCtx(() => _cache[7] || (_cache[7] = [_createTextVNode(\"保存\")])),\n      _: 1 /* STABLE */,\n      __: [7]\n    })]),\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      model: $setup.editingReview\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"评分\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_rate, {\n          modelValue: $setup.editingReview.rating,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.editingReview.rating = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"评价内容\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $setup.editingReview.content,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.editingReview.content = $event),\n          type: \"textarea\",\n          rows: 4\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createVNode","_component_el_table","data","$setup","reviews","border","style","default","_withCtx","_component_el_table_column","prop","label","width","row","_hoisted_2","_component_el_image","src","productImage","fit","_hoisted_3","_hoisted_4","_toDisplayString","productName","_hoisted_5","productPrice","toFixed","quantity","_","scope","_component_el_rate","modelValue","rating","$event","disabled","_component_el_button","size","onClick","editReview","_cache","_createTextVNode","__","type","deleteReview","length","_createBlock","_component_el_empty","key","description","_createCommentVNode","_component_el_dialog","editDialogVisible","title","footer","saveEdit","_component_el_form","model","editingReview","_component_el_form_item","_component_el_input","content","rows"],"sources":["E:\\实验例子\\project\\src\\components\\UserReviews.vue"],"sourcesContent":["<template>\r\n  <div class=\"user-reviews\">\r\n    <h2>评价管理</h2>\r\n    \r\n    <el-table :data=\"reviews\" border style=\"width: 100%\">\r\n      <el-table-column prop=\"orderId\" label=\"订单ID\" width=\"120\" />\r\n      \r\n      <el-table-column label=\"商品信息\" width=\"300\">\r\n        <template #default=\"{ row }\">\r\n          <div class=\"product-info\">\r\n            <el-image \r\n              :src=\"row.productImage || '/placeholder-product.jpg'\"\r\n              style=\"width: 60px; height: 60px;\"\r\n              fit=\"cover\"\r\n            />\r\n            <div class=\"product-details\">\r\n              <div class=\"product-name\">{{ row.productName || '商品信息缺失' }}</div>\r\n              <div class=\"product-price\">¥{{ (row.productPrice || 0).toFixed(2) }} × {{ row.quantity || 1 }}</div>\r\n            </div>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      \r\n      <el-table-column label=\"评分\" width=\"120\">\r\n        <template #default=\"scope\">\r\n          <el-rate \r\n            v-model=\"scope.row.rating\"\r\n            disabled\r\n            show-score\r\n            text-color=\"#ff9900\"\r\n          />\r\n        </template>\r\n      </el-table-column>\r\n      \r\n      <el-table-column prop=\"content\" label=\"评价内容\" />\r\n      \r\n      <el-table-column prop=\"date\" label=\"评价时间\" width=\"180\" />\r\n      \r\n      <el-table-column label=\"操作\" width=\"150\">\r\n        <template #default=\"{ row }\">\r\n          <el-button size=\"small\" @click=\"editReview(row)\">编辑</el-button>\r\n          <el-button type=\"danger\" size=\"small\" @click=\"deleteReview(row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <el-empty \r\n      v-if=\"reviews.length === 0\" \r\n      description=\"暂无评价记录\"\r\n      class=\"empty-tip\"\r\n    />\r\n\r\n    <!-- 编辑对话框 -->\r\n    <el-dialog v-model=\"editDialogVisible\" title=\"编辑评价\">\r\n      <el-form :model=\"editingReview\">\r\n        <el-form-item label=\"评分\">\r\n          <el-rate v-model=\"editingReview.rating\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"评价内容\">\r\n          <el-input\r\n            v-model=\"editingReview.content\"\r\n            type=\"textarea\"\r\n            :rows=\"4\"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"editDialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveEdit\">保存</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nconst reviews = ref([])\r\nconst editDialogVisible = ref(false)\r\nconst editingReview = ref({})\r\n\r\nconst loadReviews = () => {\r\n  const savedReviews = JSON.parse(localStorage.getItem('productReviews') || '[]')\r\n  \r\n  // 获取所有订单数据\r\n  const orders = JSON.parse(localStorage.getItem('orders') || '[]')\r\n  \r\n  // 为评价数据添加商品信息\r\n  reviews.value = savedReviews.map(review => {\r\n    // 查找对应的订单\r\n    const order = orders.find(o => o.orderId === review.orderId)\r\n    if (order) {\r\n      // 在订单中查找对应的商品\r\n      const product = order.items.find(item => item.id === review.productId)\r\n      if (product) {\r\n        return {\r\n          ...review,\r\n          productName: product.name,\r\n          productImage: product.image,\r\n          productPrice: product.price,\r\n          quantity: product.quantity\r\n        }\r\n      }\r\n    }\r\n    \r\n    // 如果没有找到匹配的订单或商品，保留原始评价数据\r\n    return review\r\n  })\r\n}\r\n\r\nconst editReview = (review) => {\r\n  editingReview.value = { ...review }\r\n  editDialogVisible.value = true\r\n}\r\n\r\nconst deleteReview = (review) => {\r\n  const newReviews = JSON.parse(localStorage.getItem('productReviews') || [])\r\n    .filter(r => !(r.orderId === review.orderId && r.productId === review.productId))\r\n  localStorage.setItem('productReviews', JSON.stringify(newReviews))\r\n  loadReviews()\r\n  ElMessage.success('删除成功')\r\n}\r\n\r\nconst saveEdit = () => {\r\n  const newReviews = JSON.parse(localStorage.getItem('productReviews') || [])\r\n  const index = newReviews.findIndex(r => \r\n    r.orderId === editingReview.value.orderId && \r\n    r.productId === editingReview.value.productId\r\n  )\r\n  \r\n  if (index > -1) {\r\n    newReviews[index] = {\r\n      ...editingReview.value,\r\n      date: new Date().toLocaleString()\r\n    }\r\n    localStorage.setItem('productReviews', JSON.stringify(newReviews))\r\n    ElMessage.success('修改成功')\r\n    editDialogVisible.value = false\r\n    loadReviews()\r\n  }\r\n}\r\n\r\nonMounted(loadReviews)\r\n</script>\r\n\r\n<style scoped>\r\n.user-reviews {\r\n  padding: 20px;\r\n  background: #fff;\r\n}\r\n\r\n.empty-tip {\r\n  margin-top: 50px;\r\n}\r\n\r\n.product-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.product-details {\r\n  flex: 1;\r\n}\r\n\r\n.product-name {\r\n  font-weight: 500;\r\n  margin-bottom: 5px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n}\r\n\r\n.product-price {\r\n  color: #f56c6c;\r\n  font-size: 14px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}