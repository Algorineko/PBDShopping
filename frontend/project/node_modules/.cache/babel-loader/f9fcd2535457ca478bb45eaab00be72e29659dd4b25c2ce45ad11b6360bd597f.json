{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"user-reviews\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_rate = _resolveComponent(\"el-rate\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[2] || (_cache[2] = _createElementVNode(\"h2\", null, \"评价管理\", -1 /* HOISTED */)), _createVNode(_component_el_table, {\n    data: $setup.reviews,\n    border: \"\",\n    style: {\n      \"width\": \"100%\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_table_column, {\n      prop: \"productName\",\n      label: \"商品名称\",\n      width: \"200\"\n    }, {\n      default: _withCtx(({\n        row\n      }) => [_createVNode(_component_router_link, {\n        to: `/buyer/product/${row.productId}`\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString(row.productName), 1 /* TEXT */)]),\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_table_column, {\n      label: \"评分\",\n      width: \"120\"\n    }, {\n      default: _withCtx(scope => [_createVNode(_component_el_rate, {\n        modelValue: scope.row.rating,\n        \"onUpdate:modelValue\": $event => scope.row.rating = $event,\n        disabled: \"\",\n        \"show-score\": \"\",\n        \"text-color\": \"#ff9900\"\n      }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_table_column, {\n      prop: \"content\",\n      label: \"评价内容\"\n    }), _createVNode(_component_el_table_column, {\n      prop: \"date\",\n      label: \"评价时间\",\n      width: \"180\"\n    }), _createVNode(_component_el_table_column, {\n      label: \"操作\",\n      width: \"150\"\n    }, {\n      default: _withCtx(({\n        row\n      }) => [_createVNode(_component_el_button, {\n        size: \"small\",\n        onClick: $event => $setup.editReview(row)\n      }, {\n        default: _withCtx(() => _cache[0] || (_cache[0] = [_createTextVNode(\"编辑\")])),\n        _: 2 /* DYNAMIC */,\n        __: [0]\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_el_button, {\n        type: \"danger\",\n        size: \"small\",\n        onClick: $event => $setup.deleteReview(row)\n      }, {\n        default: _withCtx(() => _cache[1] || (_cache[1] = [_createTextVNode(\"删除\")])),\n        _: 2 /* DYNAMIC */,\n        __: [1]\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"data\"])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createVNode","_component_el_table","data","$setup","reviews","border","style","default","_withCtx","_component_el_table_column","prop","label","width","row","_component_router_link","to","productId","_createTextVNode","_toDisplayString","productName","_","scope","_component_el_rate","modelValue","rating","$event","disabled","_component_el_button","size","onClick","editReview","_cache","__","type","deleteReview"],"sources":["E:\\实验例子\\project\\src\\components\\UserReviews.vue"],"sourcesContent":["<template>\r\n  <div class=\"user-reviews\">\r\n    <h2>评价管理</h2>\r\n    \r\n    <el-table :data=\"reviews\" border style=\"width: 100%\">\r\n      <el-table-column prop=\"productName\" label=\"商品名称\" width=\"200\">\r\n        <template #default=\"{ row }\">\r\n          <router-link :to=\"`/buyer/product/${row.productId}`\">\r\n            {{ row.productName }}\r\n          </router-link>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"评分\" width=\"120\">\r\n        <template #default=\"scope\">\r\n          <el-rate \r\n            v-model=\"scope.row.rating\"\r\n            disabled\r\n            show-score\r\n            text-color=\"#ff9900\"\r\n          />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"content\" label=\"评价内容\" />\r\n      <el-table-column prop=\"date\" label=\"评价时间\" width=\"180\" />\r\n      <el-table-column label=\"操作\" width=\"150\">\r\n        <template #default=\"{ row }\">\r\n          <el-button size=\"small\" @click=\"editReview(row)\">编辑</el-button>\r\n          <el-button type=\"danger\" size=\"small\" @click=\"deleteReview(row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nconst reviews = ref([])\r\nconst editDialogVisible = ref(false)\r\nconst editingReview = ref({})\r\n\r\nconst loadReviews = () => {\r\n  const savedReviews = JSON.parse(localStorage.getItem('productReviews') || '[]')\r\n  reviews.value = savedReviews.map(review => ({\r\n    ...review,\r\n    productName: getProductName(review.productId)\r\n  }))\r\n}\r\n\r\nconst getProductName = (productId) => {\r\n  const orders = JSON.parse(localStorage.getItem('orders') || [])\r\n  for(const order of orders) {\r\n    const item = order.items.find(i => i.productId === productId)\r\n    if(item) return item.productName\r\n  }\r\n  return '未知商品'\r\n}\r\n\r\n\r\nconst editReview = (review) => {\r\n  editingReview.value = { ...review }\r\n  editDialogVisible.value = true\r\n}\r\n\r\nconst deleteReview = (review) => {\r\n  const newReviews = JSON.parse(localStorage.getItem('productReviews') || [])\r\n    .filter(r => !(r.orderId === review.orderId && r.productId === review.productId))\r\n  localStorage.setItem('productReviews', JSON.stringify(newReviews))\r\n  loadReviews()\r\n  ElMessage.success('删除成功')\r\n}\r\n\r\nconst saveEdit = () => {\r\n  const newReviews = JSON.parse(localStorage.getItem('productReviews') || [])\r\n  const index = newReviews.findIndex(r => \r\n    r.orderId === editingReview.value.orderId && \r\n    r.productId === editingReview.value.productId\r\n  )\r\n  \r\n  if (index > -1) {\r\n    newReviews[index] = {\r\n      ...editingReview.value,\r\n      date: new Date().toLocaleString()\r\n    }\r\n    localStorage.setItem('productReviews', JSON.stringify(newReviews))\r\n    ElMessage.success('修改成功')\r\n    editDialogVisible.value = false\r\n    loadReviews()\r\n  }\r\n}\r\n\r\nonMounted(loadReviews)\r\n</script>\r\n\r\n<style scoped>\r\n.user-reviews {\r\n  padding: 20px;\r\n  background: #fff;\r\n}\r\n\r\n.empty-tip {\r\n  margin-top: 50px;\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAc;;;;;;;uBAAzBC,mBAAA,CA8BM,OA9BNC,UA8BM,G,0BA7BJC,mBAAA,CAAa,YAAT,MAAI,sBAERC,YAAA,CA0BWC,mBAAA;IA1BAC,IAAI,EAAEC,MAAA,CAAAC,OAAO;IAAEC,MAAM,EAAN,EAAM;IAACC,KAAmB,EAAnB;MAAA;IAAA;;IAJrCC,OAAA,EAAAC,QAAA,CAKM,MAMkB,CANlBR,YAAA,CAMkBS,0BAAA;MANDC,IAAI,EAAC,aAAa;MAACC,KAAK,EAAC,MAAM;MAACC,KAAK,EAAC;;MAC1CL,OAAO,EAAAC,QAAA,CAChB,CAEc;QAHMK;MAAG,OACvBb,YAAA,CAEcc,sBAAA;QAFAC,EAAE,oBAAoBF,GAAG,CAACG,SAAS;;QAP3DT,OAAA,EAAAC,QAAA,CAQY,MAAqB,CARjCS,gBAAA,CAAAC,gBAAA,CAQeL,GAAG,CAACM,WAAW,iB;QAR9BC,CAAA;;MAAAA,CAAA;QAYMpB,YAAA,CASkBS,0BAAA;MATDE,KAAK,EAAC,IAAI;MAACC,KAAK,EAAC;;MACrBL,OAAO,EAAAC,QAAA,CAMda,KANqB,KACvBrB,YAAA,CAKEsB,kBAAA;QAnBZC,UAAA,EAeqBF,KAAK,CAACR,GAAG,CAACW,MAAM;QAfrC,uBAAAC,MAAA,IAeqBJ,KAAK,CAACR,GAAG,CAACW,MAAM,GAAAC,MAAA;QACzBC,QAAQ,EAAR,EAAQ;QACR,YAAU,EAAV,EAAU;QACV,YAAU,EAAC;;MAlBvBN,CAAA;QAsBMpB,YAAA,CAA+CS,0BAAA;MAA9BC,IAAI,EAAC,SAAS;MAACC,KAAK,EAAC;QACtCX,YAAA,CAAwDS,0BAAA;MAAvCC,IAAI,EAAC,MAAM;MAACC,KAAK,EAAC,MAAM;MAACC,KAAK,EAAC;QAChDZ,YAAA,CAKkBS,0BAAA;MALDE,KAAK,EAAC,IAAI;MAACC,KAAK,EAAC;;MACrBL,OAAO,EAAAC,QAAA,CAChB,CAA+D;QAD3CK;MAAG,OACvBb,YAAA,CAA+D2B,oBAAA;QAApDC,IAAI,EAAC,OAAO;QAAEC,OAAK,EAAAJ,MAAA,IAAEtB,MAAA,CAAA2B,UAAU,CAACjB,GAAG;;QA1BxDN,OAAA,EAAAC,QAAA,CA0B2D,MAAEuB,MAAA,QAAAA,MAAA,OA1B7Dd,gBAAA,CA0B2D,IAAE,E;QA1B7DG,CAAA;QAAAY,EAAA;wDA2BUhC,YAAA,CAA+E2B,oBAAA;QAApEM,IAAI,EAAC,QAAQ;QAACL,IAAI,EAAC,OAAO;QAAEC,OAAK,EAAAJ,MAAA,IAAEtB,MAAA,CAAA+B,YAAY,CAACrB,GAAG;;QA3BxEN,OAAA,EAAAC,QAAA,CA2B2E,MAAEuB,MAAA,QAAAA,MAAA,OA3B7Ed,gBAAA,CA2B2E,IAAE,E;QA3B7EG,CAAA;QAAAY,EAAA;;MAAAZ,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}